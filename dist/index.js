/*!
 * tools v0.0.8
 * (c) 2021-2022 zhenwei
 * Released under the MIT License.
 */
!function(e,t){e&&!e.getElementById("livereloadscript")&&((t=e.createElement("script")).async=1,t.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",t.id="livereloadscript",e.getElementsByTagName("head")[0].appendChild(t))}(self.document),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).tools={})}(this,(function(e){"use strict";function t(e,n){if("object"!=typeof e)return e;if(n.has(e))return e;switch(n.set(e),l(e)){case"array":return function(e,t,n){var r=[];return e.forEach((function(e){r.push(n(e,t))})),r}(e,n,t);case"regexp":return e;case"date":return new Date(e);default:return function(e,t,n){var r={};return Object.keys(e).forEach((function(o){r[o]=n(e[o],t)})),r}(e,n,t)}}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)},r=[],o=[],a=[],c=[],i={options:{headers:{},withCredentials:!0,responseType:"json",method:"GET",params:{}},request:{use:function(e,t){e instanceof Function&&r.push(e)}},response:{noTransform:{use:function(e,t){e instanceof Function&&o.push(e),t instanceof Function&&a.push(t)}},transform:{use:function(e,t){e instanceof Function&&c.push(e)}}}};var u=window.fetch;function s(e,t){return void 0===t&&(t={}),t=n(n({},i.options),t),r.forEach((function(e){t=e(t)})),new Promise((function(n){e=function(e,t){void 0===t&&(t={});var n=t.params,r=void 0===n?{}:n,o=Object.entries(r).reduce((function(e,t){return"".concat(e,"&").concat(t[0],"=").concat(t[1])}),"");return/\?/.test(e)?e+=o:e+="?"+o.replace("&",""),e}(e,t),u(e,t).then((function(e){o.forEach((function(t){e=t(e)}));var r=t.responseType;e[void 0===r?"json":r]().then((function(e){c.forEach((function(t){e=t(e)})),n(e)}))})).catch((function(e){a.forEach((function(t){e=t(e)}))}))}))}function l(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}s.interceptor=i,e.Uint8ArrayToString=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e.base64ToBlob=function(e){try{var t=e.split(",");if(t.length<2)return{status:"error",message:"base64格式错误"};var n=t[0].match(/:(.*?);/);if(!n)return{status:"error",message:"无法获取图片类型"};for(var r=n[1],o=atob(t[1]),a=o.length,c=new Uint8Array(a);a--;)c[a]=o.charCodeAt(a);return{status:"error",blob:new Blob([c],{type:r})}}catch(e){return{status:"error",message:"未知错误",e:e}}},e.bufferToStr=function(e){return new Uint16Array(e).reduce((function(e,t){return e+String.fromCharCode(t)}),"")},e.copyToBoard=function(e){var t=document.createElement("textarea");if(document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"))return document.execCommand("copy"),void document.body.removeChild(t);document.body.removeChild(t)},e.debonce=function(e,t){var n;return void 0===t&&(t=500),function(){var r=this;n&&clearTimeout(n),n=setTimeout((function(){e.call(r)}),t)}},e.deepCopy=function(e){return"object"!=typeof e?e:t(e,new WeakMap)},e.exportExcel=function(e){var t=e.header,n=e.data,r=e.name,o=e.deep,a=document.createElement("div"),c=document.createElement("table");c.style.fontSize="14px",c.setAttribute("cellspacing","0"),c.setAttribute("cellspacing","0"),c.setAttribute("border","1");var i=document.createElement("thead");if(2===o){var u=document.createElement("tr"),s=document.createElement("tr");u.style.height="35px",s.style.height="35px",t.forEach((function(e){if(e.children){var t=document.createElement("td");t.innerText=e.label,t.setAttribute("colspan",e.colspan.toString()),u.appendChild(t),e.children.forEach((function(e){var t=document.createElement("td");t.innerText=e.label,e.length?t.style.width=e.length+"px":t.style.width="100px",s.appendChild(t)})),i.appendChild(u),i.appendChild(s),c.appendChild(i)}else{var n=document.createElement("td");e.length?n.style.width=e.length+"px":n.style.width="100px",n.setAttribute("colspan","1"),n.setAttribute("rowspan",e.rowspan.toString(0)),n.innerText=e.label,u.appendChild(n)}}))}else{var l=document.createElement("tr");l.style.height="35px",t.forEach((function(e){var t=document.createElement("td");e.length?t.style.width=e.length+"px":t.style.width="100px",t.innerText=e.label,l.appendChild(t)})),i.appendChild(l),c.appendChild(i)}var d=[];t.forEach((function(e){e.children instanceof Array?e.children.forEach((function(e){d.push(e)})):d.push(e)}));var f=document.createElement("tbody");n.forEach((function(e,t){e.index=1+t;var n=document.createElement("tr");n.style.height="35px",d.forEach((function(t){var r;if(t.value)r="<td style=\"mso-number-format:'@'';\">".concat(t.value,"</td>");else if(/\./.test(t.key)){var o=t.key.split(".").reduce((function(e,t){return e[t]}),e);r="<td style=\"mso-number-format:'@'';\">".concat(o,"</td>")}else r="<td style=\"mso-number-format:'@'';\">".concat(e[t.key],"</td>");n.insertAdjacentHTML("beforeend",r)})),f.appendChild(n)})),c.appendChild(f),a.appendChild(c);var p=a.innerHTML,h='<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style=\'text-align:center\'>'.concat(p,"</body></html>"),m=document.createElement("a");m.setAttribute("target","_blank"),/(\.xlsx$)|(\.xls$)/.test(r)||(r+=".xlsx"),m.setAttribute("download",r),m.href="data:application/vnd.ms-excel;base64,"+function(e){return window.btoa(unescape(encodeURIComponent(e)))}(h),m.click()},e.format=function(e,t){if(void 0===e&&(e="YYYY-MM-DD hh:mm:ss"),t||(t=new Date),"number"==typeof t&&(t=new Date(t)),!(t instanceof Date))return t;var n=t.getFullYear().toString(),r=(t.getMonth()+1).toString().padStart(2,"0"),o=t.getDate().toString().padStart(2,"0"),a=t.getHours().toString().padStart(2,"0"),c=t.getMinutes().toString().padStart(2,"0"),i=t.getSeconds().toString().padStart(2,"0");return e=e.replace("YYYY",n).replace("MM",r).replace("DD",o).replace("hh",a).replace("mm",c).replace("ss",i)},e.getType=l,e.sleep=function(e){return void 0===e&&(e=500),new Promise((function(t){return setTimeout(t,e)}))},e.strToBuffer=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),r=0,o=e.length;r<o;r++)n[r]=e.charCodeAt(r);return t},e.stringToUint8Array=function(e){for(var t=[],n=0,r=e.length;n<r;++n)t.push(e.charCodeAt(n));return new Uint8Array(t)},e.throttleAtonce=function(e,t){void 0===t&&(t=500);var n=0;return function(){var r=Date.now();r-n>t&&(e.call(this),n=r)}},e.throttleLatter=function(e,t){var n;return void 0===t&&(t=500),function(){n||(n=setTimeout((function(){e.call(this),n=""}),t))}},e.zwFetch=s,Object.defineProperty(e,"__esModule",{value:!0})}));
