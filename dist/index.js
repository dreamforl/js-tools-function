!function(e,t){e&&!e.getElementById("livereloadscript")&&((t=e.createElement("script")).async=1,t.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",t.id="livereloadscript",e.getElementsByTagName("head")[0].appendChild(t))}(self.document),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).tools={})}(this,(function(e){"use strict";const t=[],n=[],o=[],r=[],a={options:{headers:{},credentials:"include",responseType:"json",method:"GET",params:{}},request:{use(e,n){e instanceof Function&&t.push(e)}},response:{noTransform:{use(e,t){e instanceof Function&&n.push(e),t instanceof Function&&o.push(t)}},transform:{use(e,t){e instanceof Function&&r.push(e)}}}};function l(e,t){const{params:n}=t,o=Object.entries(n).reduce(((e,t)=>`${e}&${t[0]}=${t[1]}`),"");return/\?/.test(e)?e+=o:e+="?"+o.replace("&",""),e}const c=window.fetch;function i(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i={...a.options,...i},t.forEach((e=>{i=e(i)})),new Promise(((t,a)=>{e=l(e,i),c(e,i).then((e=>{n.forEach((t=>{e=t(e)}));const{responseType:o}=i;e[o]().then((e=>{r.forEach((t=>{e=t(e)})),t(e)}))})).catch((e=>{o.forEach((t=>{e=t(e)}))}))}))}function s(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}i.interceptor=a,e.base64ToBlob=function(e){let t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),r=o.length,a=new Uint8Array(r);for(;r--;)a[r]=o.charCodeAt(r);return new Blob([a],{type:n})},e.copyToBoard=function(e){const t=document.createElement("textarea");return document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy")?(document.execCommand("copy"),document.body.removeChild(t),!0):(document.body.removeChild(t),!1)},e.debonce=function(e,t){let n;return function(){n&&clearTimeout(n),n=setTimeout((()=>{e.call(this)}),t)}},e.deepCopy=function(e){if("object"!=typeof e)return e;const t=new WeakMap,n=function(e,t){if("object"!=typeof e)return e;if(t.has(e))return e;t.set(e);switch(s(e)){case"array":return function(e,t,n){const o=[];return e.forEach((e=>{o.push(n(e,t))})),o}(e,t);case"regexp":return e;case"date":return new Date(e);default:return function(e,t,n){const o={};return Object.keys(e).forEach((r=>{o[r]=n(e[r],t)})),o}(e,t,n)}};return n(e,t)},e.exportExcel=function(e){let{header:t,data:n,name:o,deep:r}=e,a=document.createElement("div"),l=document.createElement("table");l.style.fontSize="14px",l.setAttribute("cellspacing","0"),l.setAttribute("cellspacing","0"),l.setAttribute("border","1");let c=document.createElement("thead");if(2===r){let e=document.createElement("tr"),n=document.createElement("tr");e.style.height="35px",n.style.height="35px",t.forEach((t=>{if(t.children){let o=document.createElement("td");o.innerText=t.label,o.setAttribute("colspan",t.colspan),e.appendChild(o),t.children.forEach((e=>{let t=document.createElement("td");t.innerText=e.label,e.length?t.style.width=e.length+"px":t.style.width="100px",n.appendChild(t)})),c.appendChild(e),c.appendChild(n),l.appendChild(c)}else{let n=document.createElement("td");t.length?n.style.width=t.length+"px":n.style.width="100px",n.setAttribute("colspan",1),n.setAttribute("rowspan",t.rowspan),n.innerText=t.label,e.appendChild(n)}}))}else{let e=document.createElement("tr");e.style.height="35px",t.forEach((t=>{let n=document.createElement("td");t.length?n.style.width=t.length+"px":n.style.width="100px",n.innerText=t.label,e.appendChild(n)})),c.appendChild(e),l.appendChild(c)}let i=[];t.forEach((e=>{e.children?e.children.forEach((e=>{i.push(e)})):i.push(e)}));let s=document.createElement("tbody");n.forEach(((e,t)=>{e.index=1+t;let n=document.createElement("tr");n.style.height="35px",i.forEach((t=>{let o;if(t.value)o=`<td style="mso-number-format:'@'';">${t.value}</td>`;else if(/\./.test(t.key)){o=`<td style="mso-number-format:'@'';">${t.key.split(".").reduce(((e,t)=>e[t]),e)}</td>`}else o=`<td style="mso-number-format:'@'';">${e[t.key]}</td>`;n.insertAdjacentHTML("beforeend",o)})),s.appendChild(n)})),l.appendChild(s),a.appendChild(l);let d=`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style='text-align:center'>${a.innerHTML}</body></html>`,u=document.createElement("a");u.setAttribute("target","_blank"),/(\.xlsx$)|(\.xls$)/.test(o)||(o+=".xlsx"),u.setAttribute("download",o),u.href="data:application/vnd.ms-excel;base64,"+function(e){return window.btoa(unescape(encodeURIComponent(e)))}(d),u.click()},e.format=function(e,t){t||(t=new Date),e||(e="YYYY-MM-DD hh:mm:ss");let n=t.getFullYear(),o=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0"),a=t.getHours().toString().padStart(2,"0"),l=t.getMinutes().toString().padStart(2,"0"),c=t.getSeconds().toString().padStart(2,"0");return e=e.replace("YYYY",n).replace("MM",o).replace("DD",r).replace("hh",a).replace("mm",l).replace("ss",c)},e.getType=s,e.pictureGray=function(e){let t=Object.prototype.toString.call(e).slice(8,-1);if("String"!==t&&"HTMLCanvasElement"!==t)throw new Error("请传入cnavas的选择器或者是cnavas对象");if("String"===t){if(!(e=document.querySelector(e)))throw new Error("请检查选择器是否有误，或者当前DOM没有canvas节点");if("HTMLCanvasElement"!==t)throw new Error("当前选择器有误，请检查选择器对应的DOM节点是否是canvas")}let n=e.getContext("2d"),o=n.getImageData(0,0,e.width,e.height),r=o.data;for(let e=0;e<r.length;e+=4){let t=(r[e]+r[e+1]+r[e+2])/3;r[e]=t,r[e+1]=t,r[e+2]=t}n.putImageData(o,0,0),console.log("图像灰度成功")},e.sleep=function(e){return new Promise((t=>setTimeout(t,e)))},e.throttleAtonce=function(e,t){let n=0;return function(){let o=Date.now();o-n>t&&(e.call(this),n=o)}},e.throttleLatter=function(e,t){let n="";return function(){n||(n=setTimeout((function(){e.call(this),n=""}),t))}},e.zwFetch=i,Object.defineProperty(e,"__esModule",{value:!0})}));
